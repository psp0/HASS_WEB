define(['exports', 'preact/jsx-runtime', 'preact/hooks', './BaseButton-9f07f6ef', './ButtonLayout-818f8ae5', './ChevronLeft-3d021cf4', './classNames-902bc74c', './UNSAFE_ConveyorBelt/themes/ConveyorBeltStyles.css', './useUser-03bad59a', './clientHints-cfef9b8d', './useConveyorBeltItem-cf31b341', './useTestId-85e3a67d'], (function(t,e,r,n,s,o,i,c,l,u,f,d){"use strict";function h(){const t=u.getClientHints().deviceType;return"phone"===t||"tablet"===t}t.ConveyorBelt=({children:t,scrollPosition:u,onScrollPositionChanged:a,arrowVisibility:m="auto",testId:v})=>{const[b,W]=r.useState(!1),[y,C]=r.useState(!1),g=r.useRef(null),x=r.useRef(null),p=r.useRef(null),B=r.useRef(null),L=r.useRef(null),R=r.useRef(null),j=r.useRef(null),E=r.useRef(null),I=r.useRef(null),[T,S]=r.useState(null),N=r.useRef(!1),[P,A]=r.useState(h()&&"auto"===m||"hidden"===m),{direction:V}=l.useUser(),{itemElementsRef:w}=((t,e,n,s)=>{const o=r.useRef(),i=r.useRef([]);r.useEffect((()=>{if(i.current&&i.current.length>0&&t){const r="ltr"===s?`0px ${n?-n.offsetWidth:0}px 0px ${e?-e.offsetWidth:0}px`:`0px ${e?-e.offsetWidth:0}px 0px ${n?-n.offsetWidth:0}px`;o.current=new IntersectionObserver(c,{root:t,rootMargin:r,threshold:1});for(const t of i.current)null!=t&&o.current.observe(t.item)}return()=>{for(const t of i.current)o.current&&null!=t&&o.current.unobserve(t.item)}}),[i,t,n,e,s]);const c=t=>{const e=i.current.map(((e,r)=>{const n=t.find((t=>t.target===e.item));return n?{item:n.target,isVisible:n.isIntersecting,isCurrent:e.isCurrent,index:r}:e}));i.current=e};return r.useMemo((()=>({itemElementsRef:i})),[i])})(g.current,B.current,p.current,V),k=d.useTestId(v),$="leftArrow"+v,F="rightArrow"+v;r.useLayoutEffect((()=>(N.current=!0,()=>{N.current=!1})),[]);r.useEffect((()=>{if(1==N.current&&0==w.current.length){const t=x.current?Array.from(x.current.querySelectorAll("[data-oj-conveyorbelt-item]")):[];if(t){let e=-1;for(const r of t){e++;const t=r;if(t){null==w.current.find((e=>e.item===t))&&w.current.push({item:t,isVisible:!1,index:e,isCurrent:!1})}}}}}),[N,w]);const U=r.useCallback((()=>{a&&a(g.current?.scrollLeft)}),[a]);r.useEffect((()=>{A(h()&&"auto"===m||"hidden"===m)}),[m]),r.useEffect((()=>{g.current&&g.current.scrollTo({left:u})}),[u]),r.useEffect((()=>{const t=g.current,e=R.current,r=j.current;return t&&e&&r&&(P||(E.current=new IntersectionObserver((t=>{t.forEach((t=>{"left"===t.target.getAttribute("data-intersection-id")?C(!t.isIntersecting):W(!t.isIntersecting)}))}),{root:t}),E.current.observe(e),E.current.observe(r)),t.addEventListener("scrollend",U)),()=>{t&&(t.removeEventListener("scrollend",U),E.current?.unobserve(e),E.current?.unobserve(r))}}),[P,U]);const D=r.useCallback((t=>{const e=(t,e,r)=>{if(!e||!r)return!1;let n,s;if(r===document.documentElement)s=0,n=document.documentElement.clientWidth;else{const t=r.getBoundingClientRect();n=b?t.right-p.current?.offsetWidth:t.right,s=b?t.left-p.current?.offsetWidth:t.left}const o=e.getBoundingClientRect();return t?o.right>n:o.left<s};if(!((t,e)=>{if(!t||!e)return!1;let r,n;if(e===document.documentElement)r=0,n=document.documentElement.clientWidth;else{const t=e.getBoundingClientRect();r=y?t.left+B.current?.offsetWidth:t.left,n=b?t.right-p.current?.offsetWidth:t.right}const s=t.getBoundingClientRect();return s.left<=n&&s.right<=n&&s.left>=r&&s.right>=r})(t,g.current)&&g.current&&x.current)if("ltr"===V){e("ltr"===V,t,g.current)?g.current.scrollTo({left:t.offsetLeft+t.offsetWidth-g.current.offsetWidth+(p.current?.offsetWidth?p.current?.offsetWidth+1:0),behavior:"smooth"}):g.current.scrollTo({left:t.offsetLeft-(B.current?.offsetWidth?B.current?.offsetWidth+1:0),behavior:"smooth"})}else{e(!1,t,g.current)?g.current.scrollTo({left:t.offsetLeft-x.current?.offsetWidth+g.current.offsetWidth-(p.current?.offsetWidth?p.current?.offsetWidth+1:0),behavior:"smooth"}):g.current.scrollTo({left:t.offsetLeft+t.offsetWidth-x.current?.offsetWidth+(B.current?.offsetWidth?B.current?.offsetWidth+1:0),behavior:"smooth"})}}),[b,y,V]);const H=()=>{const t=w.current.find((t=>0==t.isVisible&&t.index>=1&&1==w.current[t.index-1].isVisible));return t?.item},M=()=>{const t=w.current.find((t=>0==t.isVisible&&t.index<w.current.length-1&&1==w.current[t.index+1].isVisible));return t?.item},O=r.useCallback((t=>{if(I.current!==t){const e=w.current.find((e=>e.item===t)),r=w.current.find((t=>!0===t.isCurrent));if(e===r||!e)return;r&&(r.isCurrent=!1),e.isCurrent=!0,I.current=t,S(t)}}),[w]);r.useEffect((()=>{T&&I.current&&D(I.current)}),[T]);const q=!P&&("ltr"===V?b&&y?c.styles.bothButtonClipPath:y?c.styles.previousButtonClipPath:!!b&&c.styles.nextButtonClipPath:b&&y?c.styles.bothButtonClipPath:b?c.styles.previousButtonClipPath:!!y&&c.styles.nextButtonClipPath);return e.jsx(f.ConveyorBeltContext.Provider,{value:{setCurrentItem:O},children:e.jsxs("div",{ref:L,className:i.classNames([c.styles.baseStyle]),...k,children:[y&&!P&&e.jsx("div",{ref:B,class:i.classNames([c.styles.buttonContainer,"ltr"===V?c.styles.previousButton:c.styles.nextButton]),children:e.jsx(n.BaseButton,{elementDetails:{type:"span",isFocusable:!1},styling:["min"],variant:"borderless",onAction:()=>function(t,e,r){if(e&&r){const n=M();"ltr"===t?n?e.scrollTo({left:n.offsetLeft+n.offsetWidth-e.offsetWidth+(B.current?.offsetWidth?B.current?.offsetWidth+1:0),behavior:"smooth"}):e.scrollTo({left:e.scrollLeft-r,behavior:"smooth"}):n?e.scrollTo({left:n.offsetLeft-x.current?.offsetWidth+e.offsetWidth-(B.current?.offsetWidth?B.current?.offsetWidth+1:0),behavior:"smooth"}):e.scrollTo({left:e.scrollLeft+r,behavior:"smooth"})}}(V,g.current,g.current?.clientWidth),"aria-hidden":!0,testId:$,children:e.jsx(s.ButtonLayout,{display:"icons",startIcon:"ltr"===V?e.jsx(o.SvgChevronLeft,{}):e.jsx(o.SvgChevronRight,{})})})}),e.jsx("div",{className:i.classNames([c.styles.overflowContainer,q]),ref:g,children:e.jsxs("div",{className:c.styles.contentContainer,ref:x,children:[e.jsx("div",{"data-intersection-id":"left",ref:R,style:{minWidth:1}}),t,e.jsx("div",{"data-intersection-id":"right",ref:j,style:{minWidth:1}})]})}),b&&!P&&e.jsx("div",{ref:p,class:i.classNames([c.styles.buttonContainer,"ltr"===V?c.styles.nextButton:c.styles.previousButton]),children:e.jsx(n.BaseButton,{elementDetails:{type:"span",isFocusable:!1},styling:["min"],variant:"borderless",onAction:()=>function(t,e,r){if(e&&r){const n=H();"ltr"===t?n?e.scrollTo({left:(n?.offsetLeft??0)-(p.current?.offsetWidth?p.current?.offsetWidth+1:0),behavior:"smooth"}):e.scrollTo({left:e.scrollLeft+r,behavior:"smooth"}):n?e.scrollTo({left:-(x.current?.offsetWidth-(n?.offsetLeft??0))+(n?.offsetWidth??0)+(p.current?.offsetWidth?p.current?.offsetWidth+1:0),behavior:"smooth"}):e.scrollTo({left:e.scrollLeft-r,behavior:"smooth"})}}(V,g.current,g.current?.clientWidth),"aria-hidden":!0,testId:F,children:e.jsx(s.ButtonLayout,{display:"icons",startIcon:"ltr"===V?e.jsx(o.SvgChevronRight,{}):e.jsx(o.SvgChevronLeft,{})})})})]})})},t.ConveyorBeltItem=({children:t,isCurrent:r})=>{const n=f.useConveyorBeltItem({isCurrent:r});return e.jsx("div",{...n,children:t})}}));
//# sourceMappingURL=ConveyorBeltItem-f6bef00a.js.map
