define(['exports', 'preact/jsx-runtime', 'preact/hooks', './useId-93f47e0a', './Floating-3a873bc7', './Layer-8682b669', 'preact/compat', './TopLayerHost-1134809b', './useHover-78209499', './useFocus-b99be29c', './useTouch-c4d9ff65', './mergeProps-31f70810', './useAnimation-6b82844f', './useComponentTheme-ee621a15', './useTestId-85e3a67d', './useThemeInterpolations-20e5a76e', './classNames-902bc74c', './hooks/UNSAFE_useTooltip/themes/redwood/TooltipContentTheme', './EnvironmentProvider-fea74278', './useColorScheme-504ab80c'], (function(e,t,n,o,s,r,u,i,c,a,l,d,m,p,f,g,h,b,v,T){"use strict";const P=({children:e,id:o,isOpen:s,isDatatip:r,onTransitionEnd:u,testId:i,...c})=>{const a=n.useRef(null),l=n.useRef(null),d=f.useTestId(i),{baseTheme:v,variantClasses:T,styles:P}=p.useComponentTheme(b.TooltipContentRedwoodTheme,{variant:r?"datatip":"tooltip"}),x=g.useThemeInterpolations(),{nodeRef:y}=m.useAnimation(s?"mounted":"unmounted",{animationStates:{mounted:e=>{const t=e.firstChild;return{from:{maxHeight:"0",opacity:"0%"},to:{maxHeight:`${t?.offsetHeight}px`,opacity:r?"100%":"95%"},options:{duration:r?1:100,easing:[0,0,.2,1]}}},unmounted:e=>({from:{opacity:r?"100%":"95%"},to:{maxHeight:"0",opacity:"0%"},options:{duration:r?1:100,easing:[0,0,.2,1]}})},isAnimatedOnMount:!0,onAnimationEnd:()=>u?.()});return n.useEffect((()=>{a.current&&l.current?.offsetHeight&&(a.current.style.height=`${l.current?.offsetHeight}px`)}),[]),t.jsx("div",{ref:a,id:o,role:"tooltip",class:h.classNames([P.wrapper,x,v]),...d,children:t.jsx("div",{ref:y,class:P.inner,...c,children:t.jsx("div",{ref:l,class:h.classNames([T,P.content]),children:e})})})};e.useTooltipControlled=({text:e,isOpen:u=!1,variant:i="tooltip",position:m="bottom",focusStrategy:p="browser",isDisabled:f=!1,anchor:g={x:"element",y:"element"},offset:h={mainAxis:0,crossAxis:0},onToggle:b,testId:x})=>{const y=f||!e,E=n.useRef(!0),R=n.useRef(!1),[C,k]=n.useState(!y&&u?"mounting":"unmounted"),H=n.useRef(C),A=e=>{H.current=e,k(e)},[I,j]=n.useState(!1);j(!1);const F="datatip"===i,S=n.useRef(!1),w="logical"===p,L=n.useRef(!0),{hoverProps:D,isHover:B}=c.useHover({}),{touchProps:M,isTouch:N}=l.useTouch({isDisabled:f}),{focusProps:O,isFocus:_}=a.useFocus({isDisabled:B||N||w}),{hoverProps:G,isHover:U}=c.useHover({isDisabled:f}),$="pointer"===g.x||"pointer"===g.y,K=n.useRef(o.useId()),V=n.useRef(null),X=n.useRef({x:-9999,y:-9999}),Y=$&&!_?X:V,q=F?0:250,z=n.useRef(null),J=T.useColorScheme(),Q=J&&"light"!==J?"light":"dark",W=()=>{z.current&&(clearTimeout(z.current),z.current=null)},Z=n.useCallback((e=>{if(e)switch(C){case"unmounted":A("mountPending");break;case"unmounting":A("mounting"),b?.({value:!0});break;case"unmountPending":W(),A("mounted")}else switch(C){case"mounting":case"mounted":A("unmountPending");break;case"mountPending":W(),ue(),A("unmounted")}}),[C,b]);n.useEffect((()=>{E.current?E.current=!1:A(u?"mounting":"unmounting")}),[u]),n.useEffect((()=>()=>{W()}),[]),n.useEffect((()=>{L.current?L.current=!1:$&&B&&"unmounted"===C||Z(B||(_||S.current)&&!R.current||U||N)}),[B,_,U,N,$,C,Z]),n.useEffect((()=>(z.current||"mountPending"!==C&&"unmountPending"!==C||(z.current=setTimeout((()=>{W(),"mountPending"!==C&&"unmountPending"!==C||C!==H.current||b?.({value:"mountPending"===C})}),q)),()=>{W()})),[C,q,b]);const ee=e=>{S.current=!0,V.current=e,Y.current=e},te=()=>{S.current=!1},ne=w?{}:{onFocus:n.useCallback((e=>{(e.eventPhase===Event.AT_TARGET||e.eventPhase===Event.BUBBLING_PHASE&&F)&&(V.current=e.target)}),[F]),onBlur:n.useCallback((e=>{e.eventPhase===Event.AT_TARGET&&(R.current=!1)}),[])},oe={onMouseEnter:n.useCallback((e=>{V.current=e.target}),[])},se={onKeyUp:n.useCallback((e=>{"Escape"===e.code&&(e.preventDefault(),R.current=!0,b?.({value:!1}))}),[b])};let re;const ue=()=>{X.current={x:-9999,y:-9999}};if(y)re=d.mergeProps(D,O,oe,ne);else{const e={"aria-describedby":K.current,...$&&{onMouseLeave:()=>{"mounting"!==C&&W()},onMouseMove:e=>{(e=>{if("unmounted"!==C&&("datatip"!==i||"mounted"!==C))return;const t=V?.current?.getBoundingClientRect(),n=document.body.scrollLeft+(t?.left||0)+(t?.width||0),o=document.body.scrollTop+(t?.top||0)+(t?.height||0),s="pointer"===g.x?e.clientX:n,r="pointer"===g.y?e.clientY:o;"mounted"===C?(X.current={x:s,y:r},!0!==I&&j(!0)):"unmounted"===C&&(W(),z.current=setTimeout((()=>{"unmounted"===C&&(X.current={x:s,y:r},b?.({value:!0}))}),q))})(e)}}};re=d.mergeProps(D,O,M,oe,ne,e,se,w?{onLogicalFocus:ee,onLogicalBlur:te}:{})}if(y)return W(),ue(),{tooltipContent:null,tooltipProps:re};const ie=(e=>{let t="bottom";switch(e){case"top":case"end":case"bottom":case"start":t=e;break;case"top-end":t="top-end-corner";break;case"bottom-end":t="bottom-end-corner";break;case"bottom-start":t="bottom-start-corner";break;case"top-start":t="top-start-corner"}return t})(m),ce=t.jsx(P,{id:K.current,testId:x,isOpen:["mounting","mounted","unmountPending"].includes(C),...G,isDatatip:F,onTransitionEnd:()=>{"mounting"===C&&A("mounted"),"unmounting"===C&&(ue(),A("unmounted"))},children:e}),ae=t.jsx(r.Layer,{logicalParentRef:V,children:t.jsx(s.Floating,{anchorRef:Y,placement:ie,offsetValue:h,children:"tooltip"===i?t.jsx(v.EnvironmentProvider,{environment:{colorScheme:Q},children:ce}):t.jsx(t.Fragment,{children:ce})})});return{tooltipContent:!["unmounted","mountPending"].includes(C)&&ae,tooltipProps:re}}}));
//# sourceMappingURL=useTooltipControlled-ca5c213a.js.map
