define(["require","exports","knockout","../viewModels/messageModule","./models","./scriptExecutionModels"],(function(require,e,s,t,n,i){"use strict";var a;Object.defineProperty(e,"__esModule",{value:!0}),e.TemplateViewProvider=e.ViewFactory=e.MessageWindow=void 0,function(e){e[e.none=0]="none",e[e.sendMessageToScriptModule=1]="sendMessageToScriptModule",e[e.sendMessageToExplainWindowforShowSQL=2]="sendMessageToExplainWindowforShowSQL",e[e.sendMessageToExecutionPlanWindowforShowSQL=3]="sendMessageToExecutionPlanWindowforShowSQL",e[e.ignoreMessge=4]="ignoreMessge"}(a=e.MessageWindow||(e.MessageWindow={}));class o{constructor(){this._viewProviders=new Map}static get instance(){if(null==this._instance){const e=new o;e.viewProviders.set("messageModule",new r),e.viewProviders.set("template",new d),e.viewProviders.set("explainPlanQueryResultsModule",new l),e.viewProviders.set("executionPlanQueryResultsModule",new c),e.viewProviders.set("realTimeSqlMonitoringDetail",new u),this._instance=e}return this._instance}get viewProviders(){return this._viewProviders}set viewProviders(e){this._viewProviders=e}createAndBindView(e,s){if(this._viewProviders.get(e)){return this._viewProviders.get(e).createView(s)}return null}}e.ViewFactory=o;class r{getMessageWindow(e){let s=a.sendMessageToScriptModule;if(e.uiDisplayMode==i.UIDisplayMode.executeExplainPlanSQL||e.uiDisplayMode==i.UIDisplayMode.executeDBMSExplainPlanSQL){if(e.ds&&e.ds.data&&e.ds.data instanceof n.QueryMessage){let t=e.ds.data;s=t.isError?a.sendMessageToScriptModule:t.statement?a.sendMessageToExplainWindowforShowSQL:a.ignoreMessge}}else if((e.uiDisplayMode==i.UIDisplayMode.ExecutionPlanGrid||e.uiDisplayMode==i.UIDisplayMode.DBMSExecutionPlanText)&&e.ds&&e.ds.data&&e.ds.data instanceof n.QueryMessage){let t=e.ds.data;s=t.isError?a.sendMessageToScriptModule:t.statement?a.sendMessageToExecutionPlanWindowforShowSQL:a.ignoreMessge}return s}createView(e){const s={message:e.ds.data,moduleRenderingCompleted:e.ds.moduleRenderingCompleted,index:e.ds.observableIndex,uiMode:e.uiDisplayMode,visible:e.visibility},n=new t(s),i=this.generateView(n);switch(this.getMessageWindow(e)){case a.sendMessageToExplainWindowforShowSQL:document.querySelector("#sqlContainer").appendChild(i);break;case a.sendMessageToExecutionPlanWindowforShowSQL:document.querySelector("#exeSQLContainer").appendChild(i);break;case a.sendMessageToScriptModule:document.querySelector("#customResultContainer").appendChild(i)}}generateView(e){let s;const t=document.createElement("div");if(t.id="module"+e.index,t.onload=e.handleTransitionCompleted,e.showSQL()){const t=document.createElement("div"),n=document.createElement("pre");t.appendChild(n),n.classList.add("messageColorTag"),n.innerText=e.message.displaySQL,s=t}if(e.showMessage()&&e.IsMessageStatement()){const t=document.createElement("div"),n=document.createElement("pre");t.appendChild(n),n.classList.add("sqlPrompt"),n.style.display="inline",n.innerText=e.message.sqlStatement.prompt;const i=document.createElement("pre");t.appendChild(i),i.classList.add("messageColorTag"),i.style.display="inline",i.innerText=e.message.sqlStatement.firstLine;const a=document.createElement("pre");t.appendChild(a),a.classList.add("messageColorTag"),a.innerText=e.message.sqlStatement.remainderLines,s=t}if(e.showMessage()&&!e.IsMessageStatement()&&!e.IsdescribeResult()){const t=document.createElement("div");let n="normalMessage break-word",i="messageColorTag";e.message.isError&&(n="errorMessage break-word",i="errorMessage"),t.className=n;const a=document.createElement("pre");t.appendChild(a),a.classList.add(i),a.innerText=e.message.message,s=t}if(e.showMessage()&&!e.IsMessageStatement()&&e.IsdescribeResult()){const t=document.createElement("div");let n="normalMessage break-word",i="messageColorTag";e.message.isError&&(n="errorMessage break-word",i="errorMessage"),t.className=n;const a=document.createElement("div");a.id="describeResult-container",a.className="descTableBody";e.describeResult;t.innerHTML=e.message.message,s=t}return s.id="moduleMessage"+e.index,e.visible||s.classList.add("hideElement"),t.appendChild(s),t}}class d{createView(e){this._template||(this._template=document.querySelector("#dataTemplate"));const t=this._template.content.cloneNode(!0).firstElementChild;this._resultContainer||(this._resultContainer=document.querySelector("#customResultContainer")),this._resultContainer.appendChild(t),s.applyBindings(e,t)}}e.TemplateViewProvider=d;class l{createView(e){this._template||(this._template=document.querySelector("#dataTemplate"));const t=this._template.content.cloneNode(!0).firstElementChild;this._resultContainer||(this._resultContainer=document.querySelector("#customResultContainer")),this._resultContainer.appendChild(t),s.applyBindings(e,t)}}class c{createView(e){this._template||(this._template=document.querySelector("#dataTemplate"));const t=this._template.content.cloneNode(!0).firstElementChild;this._resultContainer||(this._resultContainer=document.querySelector("#customResultContainer")),this._resultContainer.appendChild(t),s.applyBindings(e,t)}}class u{createView(e){this._template||(this._template=document.querySelector("#dataTemplate"));const t=this._template.content.cloneNode(!0).firstElementChild;this._resultContainer||(this._resultContainer=document.querySelector("#customResultContainer")),this._resultContainer.appendChild(t),s.applyBindings(e,t)}}}));